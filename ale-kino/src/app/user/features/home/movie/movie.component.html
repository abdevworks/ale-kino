<section
  class="movie"
  *ngIf="(authStateService.auth$ | async)?.role as userRole"
>
  <div class="movie__image">
    <div class="movie__image-container">
      <p class="movie__image-text" *ngIf="movie.movieInfo.premiere">Premiera</p>
      <img
        class="movie__image-picture"
        [src]="movie.movieInfo.image"
        alt=""
      /><img />
    </div>
  </div>
  <div class="movie__details">
    <h3 class="movie__details-title">
      {{ movie.movieInfo.title | uppercase }}
    </h3>
    <div class="movie__details-tags">
      {{ movie.movieInfo.tags }} | {{ movie.movieInfo.length }} minut |
      {{ movie.movieInfo.rated }}
    </div>

    <div
      class="movie__details-description"
      [ngClass]="{ 'text-short': textShort }"
    >
      {{ movie.movieInfo.description }}
    </div>
    <div class="movie__details-more">
      <div class="hover-effect text-more" (click)="toggleTextLength()">
        Czytaj więcej
      </div>
    </div>

    <app-time-nav
      *ngIf="movie.screenings"
      [screenings]="movie.screenings"
    ></app-time-nav>
  </div>
  <div class="movie__additional-info">
    <div class="movie__additional-info__score movie__additional-info__display">
      <div class="movie__additional-info__score-number">
        {{
          movie.movieInfo.score
            ? (movie.movieInfo.score.points / movie.movieInfo.score.votes
                | number : "1.0-0") + "/10"
            : "N/A"
        }}
      </div>
      <div class="movie__additional-info__text">Średnia ocena</div>
    </div>

    <div *ngIf="(userStateService.user$ | async)?.ratedMovies as ratedMovies">
      <div
        class="movie__additional-info__rate-it movie__additional-info__display"
        *ngIf="
          userRole === 'user' &&
          !userStateService.movieOnTheList(movie.movieInfo.id!, ratedMovies)
        "
      >
        <mat-icon
          class="movie__additional-info__icon hover-effect"
          (click)="openDialog(movie.movieInfo.id!)"
          >thumbs_up_down</mat-icon
        >
        <div class="movie__additional-info__text">Oceń ten film!</div>
      </div>
    </div>

    <div *ngIf="(userStateService.user$ | async)?.movieWatchList as movieWatchList" class="movie__additional-info__container">
      <div
        class="movie__additional-info__rate-it movie__additional-info__display"
        *ngIf="userRole === 'user'"
      >
        <mat-icon
          class="movie__additional-info__icon hover-effect"
          (click)="toggleWatchListMovie(movie.movieInfo.id!)"
          >{{userStateService.movieOnTheList(movie.movieInfo.id!, movieWatchList) ? "favorite" : "favorite_outline"}}</mat-icon
        >
        <div class="movie__additional-info__text">Chcę obejrzeć</div>
      </div>
    </div>
  </div>
</section>
